
#terminal:
ssh username@quest.northwestern.edu
ssh nst8960@quest.northwestern.edu

#will enter password - go to personal folder
cd /projects/p31966/ntaqatqa

#create study folder inside personal folder
mkdir Baldo 
cd Baldo

#download .gz files from SRA Explorer
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/018/SRR15992218/SRR15992218_1.fastq.gz -o SRR15992218_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/018/SRR15992218/SRR15992218_2.fastq.gz -o SRR15992218_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/015/SRR15992215/SRR15992215_1.fastq.gz -o SRR15992215_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/015/SRR15992215/SRR15992215_2.fastq.gz -o SRR15992215_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/017/SRR15992217/SRR15992217_1.fastq.gz -o SRR15992217_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/017/SRR15992217/SRR15992217_2.fastq.gz -o SRR15992217_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/020/SRR15992220/SRR15992220_1.fastq.gz -o SRR15992220_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/020/SRR15992220/SRR15992220_2.fastq.gz -o SRR15992220_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/019/SRR15992219/SRR15992219_1.fastq.gz -o SRR15992219_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/019/SRR15992219/SRR15992219_2.fastq.gz -o SRR15992219_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/016/SRR15992216/SRR15992216_1.fastq.gz -o SRR15992216_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/016/SRR15992216/SRR15992216_2.fastq.gz -o SRR15992216_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/012/SRR15992212/SRR15992212_1.fastq.gz -o SRR15992212_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/012/SRR15992212/SRR15992212_2.fastq.gz -o SRR15992212_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/013/SRR15992213/SRR15992213_1.fastq.gz -o SRR15992213_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/013/SRR15992213/SRR15992213_2.fastq.gz -o SRR15992213_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/014/SRR15992214/SRR15992214_1.fastq.gz -o SRR15992214_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/014/SRR15992214/SRR15992214_2.fastq.gz -o SRR15992214_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/011/SRR15992211/SRR15992211_1.fastq.gz -o SRR15992211_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/011/SRR15992211/SRR15992211_2.fastq.gz -o SRR15992211_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/010/SRR15992210/SRR15992210_1.fastq.gz -o SRR15992210_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/010/SRR15992210/SRR15992210_2.fastq.gz -o SRR15992210_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/009/SRR15992209/SRR15992209_1.fastq.gz -o SRR15992209_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/009/SRR15992209/SRR15992209_2.fastq.gz -o SRR15992209_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/008/SRR15992208/SRR15992208_1.fastq.gz -o SRR15992208_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/008/SRR15992208/SRR15992208_2.fastq.gz -o SRR15992208_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/007/SRR15992207/SRR15992207_1.fastq.gz -o SRR15992207_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/007/SRR15992207/SRR15992207_2.fastq.gz -o SRR15992207_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/006/SRR15992206/SRR15992206_1.fastq.gz -o SRR15992206_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/006/SRR15992206/SRR15992206_2.fastq.gz -o SRR15992206_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/005/SRR15992205/SRR15992205_1.fastq.gz -o SRR15992205_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/005/SRR15992205/SRR15992205_2.fastq.gz -o SRR15992205_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/004/SRR15992204/SRR15992204_1.fastq.gz -o SRR15992204_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/004/SRR15992204/SRR15992204_2.fastq.gz -o SRR15992204_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/003/SRR15992203/SRR15992203_1.fastq.gz -o SRR15992203_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/003/SRR15992203/SRR15992203_2.fastq.gz -o SRR15992203_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/002/SRR15992202/SRR15992202_1.fastq.gz -o SRR15992202_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/002/SRR15992202/SRR15992202_2.fastq.gz -o SRR15992202_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/001/SRR15992201/SRR15992201_1.fastq.gz -o SRR15992201_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/001/SRR15992201/SRR15992201_2.fastq.gz -o SRR15992201_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/000/SRR15992200/SRR15992200_1.fastq.gz -o SRR15992200_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/000/SRR15992200/SRR15992200_2.fastq.gz -o SRR15992200_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/099/SRR15992199/SRR15992199_1.fastq.gz -o SRR15992199_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/099/SRR15992199/SRR15992199_2.fastq.gz -o SRR15992199_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/097/SRR15992197/SRR15992197_1.fastq.gz -o SRR15992197_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/097/SRR15992197/SRR15992197_2.fastq.gz -o SRR15992197_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/098/SRR15992198/SRR15992198_1.fastq.gz -o SRR15992198_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/098/SRR15992198/SRR15992198_2.fastq.gz -o SRR15992198_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/096/SRR15992196/SRR15992196_1.fastq.gz -o SRR15992196_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/096/SRR15992196/SRR15992196_2.fastq.gz -o SRR15992196_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/095/SRR15992195/SRR15992195_1.fastq.gz -o SRR15992195_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/095/SRR15992195/SRR15992195_2.fastq.gz -o SRR15992195_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/094/SRR15992194/SRR15992194_1.fastq.gz -o SRR15992194_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/094/SRR15992194/SRR15992194_2.fastq.gz -o SRR15992194_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/093/SRR15992193/SRR15992193_1.fastq.gz -o SRR15992193_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/093/SRR15992193/SRR15992193_2.fastq.gz -o SRR15992193_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/092/SRR15992192/SRR15992192_1.fastq.gz -o SRR15992192_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/092/SRR15992192/SRR15992192_2.fastq.gz -o SRR15992192_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/091/SRR15992191/SRR15992191_1.fastq.gz -o SRR15992191_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_1.fastq.gz
curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR159/091/SRR15992191/SRR15992191_2.fastq.gz -o SRR15992191_16S_amplicon_sequencing_of_Podarcis_lilfordi_gut_microbiota_2.fastq.gz

#getting the absolute file paths, for forward reads first and then for reverse reads  
ls -d "$PWD/"*_1.fastq.gz
ls -d "$PWD/"*_2.fastq.gz

#creating manifest.txt file
#in terminal
vim Baldo_manifest.text
i
#will copy paste spreadsheet in here
#esc tab to exit, and :wq to save. Press enter
:wq 

#request memory to compute - exit login mode and enter compute node: we can change partition to normal
srun --account=p31966 --time=2:00:00 --partition=normal --mem=4G --pty bash -l

#loading qiime2
module load qiime2/2022.8

#creating demux.qza file from manifest.txt
qiime tools import \
  --type 'SampleData[PairedEndSequencesWithQuality]' \
  --input-path Baldo_manifest.text \
  --output-path Baldo-paired-end-demux.qza \
  --input-format PairedEndFastqManifestPhred33V2

#visualizing the demultiplixing - it changes qza to qzv//change name of study// paired or paired end
#use qiime 2 view to upload the .qzv file to decide on a truncating length for next step. 150 nucleotides
#use cyberduck to download .qzv file after creating it: SSh| 22| quest.northwestern.edu| nst8960| netid password
qiime demux summarize \
--i-data Baldo-paired-end-demux.qza \
--o-visualization Baldo-demux.qzv

#using DATA2 to only keep good qulaity reads: trim is for starting point, truncate is for how many bases
#the very first line should include the #! 
vim Baldo_dada2.sh
i
#!/bin/bash
#SBATCH -J dada2
#SBATCH --mail-type=ALL
#SBATCH -A p31966
#SBATCH --mail-user=nourtaqatqa2025@u.northwestern.edu
#SBATCH -N 1
#SBATCH -n 6
#SBATCH --mem=24G
#SBATCH -t 48:00:00
#SBATCH -p normal
#SBATCH --output=output.log  

module purge all
module load qiime2/2022.8 

qiime dada2 denoise-paired \
--i-demultiplexed-seqs Baldo-paired-end-demux.qza \
--p-trunc-len-f 150 \
--p-trunc-len-r 150 \
--p-trim-left-f 0 \
--p-trim-left-r 0 \
--p-n-threads 0 \
--o-representative-sequences Baldo-paired-end-rep-seqs.qza \
--o-table Baldo-paired-end-table.qza \
--o-denoising-stats Baldo-paired-end-stats-dada.qza

echo "Finishing dada2 job"

#save and exist : press esc 
:wq

#authorizing the sh file we just created: make sure you're in the directory of demux.qza file
chmod u+x Baldo_dada2.sh

#submitting the job
sbatch Baldo_dada2.sh
